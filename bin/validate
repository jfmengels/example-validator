#!/usr/bin/env node
'use strict'

var _ = require('lodash/fp')

var lib = require('../')

function gracefulExit(errors) {
  if (errors) {
    if (!_.isArray(errors)) {
      console.error(errors.stack || errors)
    } else if (errors.length) {
      console.error(errors.join('\n\n'))
    }
  }
  process.exit(0)
}

var fileName = process.argv[2]
lib.readers.markdown(fileName, function(error, examples) {
  if (error) {
    return gracefulExit(error)
  }
  gracefulExit(lib.processExamples({}, examples))
})
